"use strict";function modal(options){var settings={id:Math.floor(Math.random()*(1000-1+1))+1,after:function(){},width:0,before:function(){}}
$.extend(true,settings,options);var width='';if(settings.width!=0)width='style="width:auto;max-width:'+settings.width+'"';if(jQuery('.modal').length==0){var $html='<div class="modal fade" id="modal_'+settings.id+'" tabindex="-1" role="dialog" aria-labelledby="'+settings.id+'_label" aria-hidden="true">';$html+='<div class="modal-dialog" '+width+'><div class="modal-content">';$html+='<div class="modal-header">';$html+='<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>';if(settings.title){$html+='<h4 class="modal-title" id="modal_'+settings.id+'_label">'+settings.title+'</h4>';}$html+='</div>';$html+='<div class="modal-body">'+settings.body+'</div>\
        </div>\
      </div>\
      </div>';jQuery('body').append($html).promise().done(function(){var $modal=jQuery('#modal_'+settings.id);var $before=settings.before($modal);if($before!==false){if(settings.classes){$modal.addClass(settings.classes);}if(settings.title==null){$modal.addClass('no-title');}if($modal.hasClass('valign-false')==false){centerModal($modal);}$modal.on('hidden.bs.modal',function(e){$modal.remove();});$modal.on('shown.bs.modal',function(e){if(settings.after){settings.after($modal);}});$modal.modal();}else{$modal.remove();}});}}function centerModal(el){$(el).css('display','block');var $dialog=$(el).find(".modal-dialog");var offset=($(window).height()-$dialog.height())/2;var bottomMargin=$dialog.css('marginBottom');bottomMargin=parseInt(bottomMargin);if(offset<bottomMargin)offset=bottomMargin;$dialog.css("margin-top",offset);}function pop_contact_us(){$.post('/pop_contact_us.php','',function(data){modal({id:'pop_contact_us',title:data.title,body:data.html});},'json');}function showCartpopup(){$.get('/popup_cart.php',null,function(response){modal({id:'cart_popup',body:response,classes:'valign-false',after:function(){}});});}function showPopupResponse(res){updateCart();if(typeof checkout!='undefined'){checkout.updateOrderTotals();}}function doAddProduct(form){var fe=form.elements;var senddata=new Object();for(var i=0;i<fe.length;i++){if(fe[i].type=="radio"||fe[i].type=="checkbox"){if(fe[i].checked)senddata[fe[i].name]=fe[i].value;}else{senddata[fe[i].name]=fe[i].value;}}var url=form.action;$.post(url,senddata,function(data){$('#r_buy_intovar').html('<a title="'+IMAGE_BUTTON_IN_CART+'" class="btn btn-lg btn-success popup_cart" href="/shopping_cart.php">'+IMAGE_BUTTON_IN_CART+'</a>');$('.r_buy'+senddata["products_id"]).each(function(){$(this).html('<a title="'+IMAGE_BUTTON_IN_CART+'" class="btn btn-primary popup_cart" href="/shopping_cart.php">'+IMAGE_BUTTON_IN_CART+'</a>');});showCartpopup();updateCart();});}function showRequest(formData,jqForm,options){var queryString=$.param(formData);$('.refresh_icon .fa-spin').fadeIn(20);queryString='?'+queryString;return true;}function showResponse(responseText,statusText){$('.refresh_icon .fa-spin').fadeOut(20);}function updateCart(form){$.post('./ajax_update_cart.php','',function(data){$('#divShoppingCard').html(data.cart_html);$('.mobile_cart_count').html(data.cart_count);},'json');}function zoomProduct(pid){$.get('./popup_product_info.php',{'products_id':pid},function(data){$('#kratkoe').css({'width':'800','height':'auto'}).addClass('cart_popup_form');$('#kratkoe').html(data);$('a.poplight[href^=#]').click();jQuery('body,html').stop(false,false).animate({scrollTop:0},{duration:600,easing:'swing'},800);});}function zoomProductImage(act){var li=jQuery('.zoomProductView .additional_images_list li');var currentActiveThumb=jQuery('.zoomProductView .additional_images_list li.active');var href=jQuery('.zoomProductView .additional_images_list li.active').children('a').attr('data-image');li.removeClass('active');if(act=='prev'){if(currentActiveThumb.is(':first-child')){jQuery('.zoomProductView .additional_images_list li:last').addClass('active');}else{currentActiveThumb.prev().addClass('active');}}if(act=='next'){if(currentActiveThumb.is(':last-child')){jQuery('.zoomProductView .additional_images_list li:first').addClass('active');}else{currentActiveThumb.next().addClass('active');}}href=jQuery('.zoomProductView .additional_images_list li.active').children('a').attr('data-image');changeIm(href,'ch_link_pop',500,500);}function changeIm(nameof,selector,im_width,im_height,callback){if(typeof selector=="undefined")var selector='ch_link';if(typeof im_width=="undefined")var im_width=300;if(typeof im_height=="undefined")var im_height=300;var ch_im=$("#"+selector).find('img').attr('id');var img_path='http://'+window.location.host+'/getimage/'+nameof+'&w='+im_width+'&h='+im_height
if($("#"+selector+" img").length==0)$("#"+selector).html('<div><img src="" id="'+ch_im+'" /></div>');$("#"+selector+" img").fadeOut(40,function(){$("#"+selector+" img").removeAttr('width');$("#"+selector+" img").removeAttr('height');var link=document.getElementById(selector);var im=document.getElementById(ch_im);im.src=img_path;im.jqimg='/images/'+nameof;im.onload=function(){var w=im.naturalWidth;var h=im.naturalHeight;$("#"+selector+" img").fadeIn(200);if(typeof callback!="undefined"){var _callback=callback;$("#"+selector+" img").fadeIn(200,function(){_callback()});}else{$("#"+selector+" img").fadeIn(200);}}});}function setLastcols(context,element){var listing_item=jQuery(context+' '+element);var cols=Math.floor(jQuery('#center').width()/listing_item.width());jQuery(context+' '+element+':nth-of-type('+cols+'n+'+cols+')').addClass('last-col');}function scrollToEl(element){var $el=jQuery(element);var $elOffset_top=$el.offset().top;jQuery('body,html').stop(false,false).animate({scrollTop:$elOffset_top},{duration:600,easing:'swing'},800);}function scrollToTop(){jQuery('body,html').stop(false,false).animate({scrollTop:0},{duration:600,easing:'swing'},800);}function themeItems(){jQuery('.item-list li').each(function(e){jQuery(this).addClass('item_'+e);});}function showLoginvk(url){var w=635;var h=250;var lPos=(screen.width)?(screen.width-w)/2:0;var tPos=(screen.height)?(screen.height-h)/2:0;var params="menubar=no,location=yes,resizable=yes,scrollbars=no,status=no,height="+h+",width="+w+",top="+tPos+",left="+lPos;window.open(url,VK_LOGIN,params);}function checkLoginvk(id_var,first_name_var,last_name_var,photo_var,email_var,city_var,pass_var){$.get('/ext/auth/login_process.php',{id:id_var,first_name:first_name_var,last_name:last_name_var,photo:photo_var,email:email_var,city:city_var,password:pass_var},function(data){modal({id:'check_login',body:data});$.get('/ext/auth/ajax_login_top.php',{ajaxloading:true},function(data){$('#kabinet').html(data);});});}function fixMenu(menu_selector,parent,dropdown){var $menu=$(menu_selector);var $windowWidth=jQuery(window).width();var $wrapperWidth=$menu.width();var $outsideWidth=($windowWidth-$wrapperWidth)/2;$(menu_selector+''+parent).each(function(index,el){var $dropdown=$(el).find(dropdown);var $curTotalWidth=($(el).offset().left+$dropdown.outerWidth(true))-$outsideWidth;var $differenceWidth=($(el).offset().left-$outsideWidth)/2;if($curTotalWidth>$wrapperWidth){$dropdown.css({marginLeft:'-'+$differenceWidth+"px"});}});}function liFormat(row,i,num){var st='';var result='<div class="search_image_wrap"><img src="'+row[2]+'" class="picsearch"></div>'+'<p class=qnt1>'+row[0]+' </p><p class=qntp>'+row[4]+'</p>'+'<p class=qnt>'+row[1]+' </p>';return result;}function selectItem(li){if(li==null){var sValue='!';window.location="/search="+li.extra[2];}if(!!li.extra)var sValue=li.extra[2];else var sValue=li.selectValue;var tbox=document.getElementById('searchpr');if(tbox){window.location="/product_info.php?products_id="+li.extra[2];}}function calculate_sum(selected_op){var summ,sel_ops;if(selected_op.attr('data-prefix')=='='&&$('#id_option_other'+selected_op.val()).val()!='=0'){summ=($('#id_option_other'+selected_op.val()).val()).substring(1);}else{$('.select_id_option').each(function(){sel_ops=$(this).parent().find($("select option:selected"));if(sel_ops.attr('data-prefix')=='='&&$('#id_option_other'+sel_ops.val()).val()!='=0'){summ=($('#id_option_other'+sel_ops.val()).val()).substring(1);return false;}});if(!summ)summ=parseInt($('input[name=prod_price]').val());}$('.select_id_option').each(function(){sel_ops=$(this).parent().find($("select option:selected"));if(sel_ops.attr('data-prefix')=='+'||(sel_ops.attr('data-prefix')=='='&&$('#id_option_other'+sel_ops.val()).val()=='=0')){summ=parseInt(summ)+parseInt(($('#id_option_other'+sel_ops.val()).val()).substring(1));}else if(sel_ops.attr('data-prefix')=='-'){summ=summ-parseInt(($('#id_option_other'+sel_ops.val()).val()).substring(1));}});$(".new_price_card_product").html(summ);if($('input[name=prod_thousands_point]').val()!='')$(".new_price_card_product").html(numberWithCommas($(".new_price_card_product").html(),$('input[name=prod_thousands_point]').val()));if($('input[name=prod_currency_left]').val()!='')$(".new_price_card_product").prepend('<span class="currency_card_product">'+$('input[name=prod_currency_left]').val()+'</span>');if($('input[name=prod_currency_right]').val()!='')$(".new_price_card_product").append('<span class="currency_card_product">'+$('input[name=prod_currency_right]').val()+'</span>');}function ajaxSubmitSerialize(options){$('.refresh_icon .fa-spin').fadeIn(20);var pathSerialize=$('#m_srch').attr('action')+'?'+$('#m_srch').serialize();var queryString='?'+$('#m_srch').serialize();history.replaceState({foo:"bar"},"Jesus saves",document.location.pathname.toString()+queryString);var findWidthToUnveil;if(options.target){$(options.target).html('<div id="r_spisok" class="row row_catalog_products "></div>');$.post(pathSerialize,function(data){var ajax_globals=data['globals'];$.each(data,function(k,v){if(v['product_image']&&!findWidthToUnveil){findWidthToUnveil=v['product_image'].split('&')[1].split('=')[1];}if(k!='globals')$('#r_spisok').append(draw_product_block(v,ajax_globals));});showResponse();if(findWidthToUnveil){$("#r_spisok img").width(findWidthToUnveil);findWidthToUnveil=0;}$("#r_spisok img").unveil(500);$("#r_spisok img").width('100%');$('#r_spisok').after(ajax_globals['load_more']+ajax_globals['pages_html']+ajax_globals['number_of_rows']);$('#loadMoreProducts').click(function(){loadMoreProducts();});},'json');}else if(options="loadMore"){$.get(pathSerialize,function(data){var ajax_globals=data['globals'];$.each(data,function(k,v){if(v['product_image']&&!findWidthToUnveil){findWidthToUnveil=v['product_image'].split('&')[1].split('=')[1];}if(k!='globals')$('#r_spisok').append(draw_product_block(v,ajax_globals));});$($.find(".pagination .active")).next().attr("class","active");showResponse();if(findWidthToUnveil){$("#r_spisok img").width(findWidthToUnveil);findWidthToUnveil=0;}$("#r_spisok img").unveil(500);$("#r_spisok img").width('100%');$('#loadMoreI').removeClass('fa-spin');},'json');}}function loadMoreProducts(){var totalProducts=$('input[name=number_of_rows]').val();var productsPerPage=$('select[name=row_by_page] option:selected').text();var lastRedElement;var obj=$('#m_srch').serializeArray();obj.forEach(function(item){if(item['name']=="row_by_page"){productsPerPage=item['value'];}});var foundpage=false;$.each(obj,function(i,field){if(obj[i].name=="page"){lastRedElement=parseInt(obj[i].value);foundpage=true;}});var totalPagesAdjusted;if(~~(totalProducts/productsPerPage)===(totalProducts/productsPerPage)){totalPagesAdjusted=(totalProducts/productsPerPage);}else{totalPagesAdjusted=~~(totalProducts/productsPerPage)+1;}if(foundpage==false){lastRedElement=1;}if(lastRedElement>=totalPagesAdjusted){}else{$('#loadMoreI').addClass('fa-spin');$('.refresh_icon .fa-spin').fadeIn(20);var obj=$('#m_srch').serializeArray();var foundpage=false;$.each(obj,function(i,field){if(obj[i].name=="page"){lastRedElement=obj[i].value;obj[i].value=parseInt(obj[i].value)+1;$('#m_srch').prop("page").value=obj[i].value;foundpage=true;}});if(foundpage==false){$('#m_srch').append('<input id="page1" type="hidden" name="page" value="2">');lastRedElement=1;}ajaxSubmitSerialize("loadMore");}}function draw_product_block(ajax_array,ajax_globals){var $label=ajax_array['label'];var $sku='<span class="label pull-left">#'+ajax_array['product_model']+'</span>';if(ajax_array['product_stock']!="0"){var $stock='<span class="label pull-right label-black"><i class="fa fa-check"></i>'+ajax_globals['product_stock_text_in']+'</span>';}else{$stock='<span class="label pull-right label-default">'+ajax_globals['product_stock_text']+'</span>';}var $spec_price;var $price;if(ajax_array['product_spec_price'])$spec_price=ajax_array['product_spec_price'];else $spec_price="";if($spec_price!=''){$price='<span class="new_price">'+$spec_price+'</span><span class="old_price">'+ajax_array['product_price']+'</span>';}else{$price='<span class="new_price">'+ajax_array['product_price']+'</span>';}var $product_name=ajax_array['product_name'];var $product_attributes='';var productAttributesObject=ajax_array['product_attributes'];if(productAttributesObject){var $attr_limit=4;var i=0;$.each(productAttributesObject,function(index,value){if(i<$attr_limit){$product_attributes=$product_attributes+'<tr><td>'+ajax_globals['all_attribs'][index]+':</td><td> '+value+'</td></tr>';i++;}})}var $output2='<a data-id="'+ajax_array['product_id']+'" data-cid="'+ajax_globals['categories_id']+'" class="compare_button" href="#">'+'<input type="checkbox" id="compare_'+ajax_array['product_id']+'" name="compare_'+ajax_array['product_id']+'">'+'<label for="compare_'+ajax_array['product_id']+'">'+ajax_globals['compa_text']+'</label></a>';var $cart_button='<span class="r_buy'+ajax_array['product_id']+'"><input name="cart_quantity" value="1" type="hidden"><input name="products_id" value="'+ajax_array['product_id']+'" type="hidden"><button class="btn btn-primary" type="submit">'+ajax_globals['cart_addto_cart']+'</button></span>';var element='<div class="col-lg-3 col-md-4 col-sm-6 col-xs-6 col_product">'+'<form name="cart_quantity" action="'+ajax_array['product_href']+'?action=add_product" method="post" onsubmit="doAddProduct(this); return false;">'+'<div class="product">'+$label+'<div class="wrapper_product_hover"><div class="product_hover"><div class="p_description">'+'<a class="p_img_href" href="'+ajax_array['product_href']+'">'+'<img src="images/default.png" data-src="'+ajax_array['product_image']+'" title="'+ajax_array['product_name']+'"> </a>'+'<div class="art clearfix">'+$sku+$stock+'</div>'+'<div class="new_old_price"><p class="price">'+$price+'</p>'+$cart_button+'</div>'+'<a href="'+ajax_array['product_href']+'" class="model_product">'+$product_name+'</a> '+'<table class="listing_attrs">'+$product_attributes+'</table><div class="compare">'+$output2+'</div></div></div></div></div></form></div>';return element;}function numberWithCommas(x,comma){if(typeof x!='undefined')return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g,comma);}